{% extends 'base.html' %}
{% block og_title %}{{ discussion.title }}{% endblock og_title %}
{% block og_img_title %}{{ discussion.title }}{% endblock og_img_title %}
{% block og_desc %}{{ discussion.description }}{% endblock og_desc %}
{% block twitter_title %}{{ discussion.title }}{% endblock twitter_title %}
{% block twitter_img_title %}{{ discussion.title }}{% endblock twitter_img_title %}
{% block twitter_desc %}{{ discussion.description }}{% endblock twitter_desc %}
{% block title %}{{ discussion.title }}{% endblock title %}

{% block content %}
<h2 class="titlex">{{ discussion.title }}</h2>
<h5 class="titlex">Started at {{ discussion.created_at }} by <i class="fa-solid fa-user"></i> {{ discussion.creator.username }}</h5>
<p> {{ discussion.description }} <br>
    <a class="linkx" href="{% url 'Message_create' discussion.pk %}"><i class="fa-regular fa-message"></i> Post message [{{ Messages|length }}]</a>
    <a href="{% url 'toggle_like' discussion.id %}" class="like-button {% if user_has_liked %}active{% endif %}">
        {% if user_has_liked %}
        <i class="fa-solid fa-heart fa-xl"></i>
        {% else %}
        <i class="fa-regular fa-heart"></i>
        {% endif %}[{{ total_likes }}]
    </a><hr>
    <a class="like-button" href="https://www.facebook.com/sharer/sharer.php?u={{ request.build_absolute_uri }}" target="_blank">
        <i class="fab fa-facebook fa-xl"></i>
    </a>
    <a class="like-button" href="https://wa.me/?text={{ request.build_absolute_uri }}" target="_blank">
        <i class="fab fa-whatsapp fa-xl"></i>
    </a>
    <a class="like-button" href="https://twitter.com/intent/tweet?url={{ request.build_absolute_uri }}" target="_blank">
        <i class="fab fa-x-twitter" fa-xl></i>
    </a>
    <a class="like-button" href="https://www.linkedin.com/sharing/share-offsite/?url={{ request.build_absolute_uri }}" target="_blank">
        <i class="fab fa-linkedin fa-xl"></i>
    </a>
    <a class="like-button" href="mailto:?body={{ request.build_absolute_uri }}" target="_blank">
        <i class="fas fa-envelope"></i>
    </a>
    
</p>

{% for message in Messages %}
<div class="message-box">
    <span class="message-meta"><span style="{% if message.creator == request.user %}color:Blue;{% endif %}"><i class="fa-solid fa-user"></i> {{ message.creator }}</span> | {{ message.created_at|timesince }} ago</span>
    <p class="message-body">{{ message.body }}</p>
</div>
{% endfor %}
{% endblock content %}

{% block rightcontent %}
{% if participants %}
<h3 class="titlex">Participants</h3>
<ul class="listx">
{% for participant in participants %}
    <li class="itemx"><i class="fa-solid fa-user"></i> {{ participant.creator__username }}</li>
{% endfor %}
</ul>
{% else %}
<p>No participant in Discussion except you. Be first to start!</p>
{% endif %}
{% endblock rightcontent %}